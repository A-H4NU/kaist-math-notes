\documentclass[MAS212_Note.tex]{subfiles}
\begin{document}

\section{Cyclic Subspaces and Annihilators}

\dfn{\(T\)-cyclically Generated Subspace}{
    Let \(V\) be a finite-dimensional vector space over \(F\) and let \(T \in L(V)\).
    For \(\alpha \in V\), the subspace
    \[
        Z(\alpha; T) = \{\,g(T)\alpha \mid g \in F[x]\,\}
    \]
    of \(V\) is called the \textit{\(T\)-cyclic subspace generated by \(\alpha\)}.
    If \(Z(\alpha; T) = V\), then we say \(V\) is \textit{cyclically generated by} \(\alpha\),
    and \(\alpha\) is a \textit{cyclic vector for} \(T\).
}

\nt{
    \noindent Some immediate facts:
    \begin{itemize}[nolistsep]
        \ii \(Z(\alpha; T)\) is \(T\)-invariant.
        \ii \(Z(0; T) = \{0\}\).
        \ii If \(\alpha \neq 0\) is an eigenvector,
            then \(Z(\alpha; T) = \spn \{\alpha\}\).
        \ii If \(\dim Z(\alpha; T) = 1\), then \(\alpha \neq 0\) and \(Z(\alpha; T) = \spn \{\alpha\}\);
            thus \(\alpha\) is an eigenvector.
    \end{itemize}
    So, we need \(\alpha\) be neither too bad nor too good to utilize \(Z(\alpha; T)\).
}

\dfn{\(T\)-annihilator}{
    Let \(V\) be a finite-dimensional vector space over \(F\) and let \(T \in L(V)\).
    For \(\alpha \in V\), the \textit{\(T\)-annihilator of} \(\alpha\) is the subspace
    \[
        M(\alpha; T) \triangleq \{\,g \in F[x] \mid g(T)\alpha = 0\,\}.
    \]
    In other words, \(M(\alpha; T) = S_T(\alpha; \{0\})\).
}
\nt{
    \(T\)-annihilator of \(\alpha\) is the \(T\)-conductor of \(\alpha\) to \(\{0\}\),
    \(M(\alpha; T)\) is a nonzero ideal and thus has a unique monic generator \(p_{\alpha}\).
    \(p_{\alpha}\) is also called the \(T\)-annihilator of \(\alpha\)
    Hence, as the minimal polynomial \(m\) of \(T\) resides in \(M(\alpha; T)\),
    we have \(p_{\alpha} \mid m\).
}

\thm[]{}{
    Let \(V\) be a finite-dimensional vector space over \(F\) and let \(T \in L(V)\).
    Let \(\alpha \in V \setminus \{0\}\) be fixed.
    Let \(p_{\alpha}\) be the \(T\)-annihilator of \(\alpha\).
    \begin{enumerate}[nolistsep, label=(\roman*)]
        \ii If \(k = \deg p_{\alpha}\),
            \(\{\alpha, T \alpha, \cdots, T^{k-1}\alpha\}\)
            is a basis for \(Z(\alpha; T)\), hence \(\deg p_{\alpha} = \dim Z(\alpha; T)\).
        \ii Let \(U \triangleq T \big|_{Z(\alpha; T)} \in L(Z(\alpha; T))\). 
            Then, the minimal polynomial of \(U\) is \(p_\alpha\).
    \end{enumerate}
}
\pf{Proof}{
\hfill
\begin{enumerate}[nolistsep, label=(\roman*), listparindent=\parindent]
    \ii 
    Let \(g \in F[x]\) be arbitrary.
    By \Cref{th:euclid}, we have \(g = p_{\alpha}q + r\) where \(q, r \in F[x]\)
    in which either \(r = 0\) or \(r \neq 0\) and \(\deg r < \deg p_{\alpha}\).
    As \((p_{\alpha}) = M(\alpha; T)\), we also have \(p_{\alpha} q \in M(\alpha; T)\),
    and thus
    \[
        g(T) \alpha = q(T) p_{\alpha}(T) \alpha + r(T) \alpha = r(T) \alpha.
    \]
    Hence, \(Z(\alpha; T) = \spn \{\alpha, T \alpha, \cdots, T^{k-1} \alpha\}\).
    We are left with proving that they are linearly independent.

    Suppose they are not linearly independent for the sake of contradiction.
    Then there exist \(c_0, \cdots, c_{k-1} \in F\) not all zero such that
    \(\big(\sum_{i=0}^{k-1} c_i T^i\big) \alpha = 0\),
    which means \(g_0(x) = \sum_{i=0}^{k-1} c_i x^i \in M(\alpha; T)\)
    with \(\deg g_0 < \deg p_{\alpha}\), violating the minimality of \(p_{\alpha}\).
    Hence, they are linearly independent.

    \ii
    Take any \(v \in Z(\alpha; T)\). Then, there exists \(g \in F[x]\)
    so \(v = g(T) \alpha\).
    Then, \(p_{\alpha}(U) v = g(T) p_{\alpha}(T) \alpha = 0\).
    Hence, \(p_{\alpha}(U) = 0\).

    Moreover, there does not exist \(q \in F[x]\) with \(q(U) = 0\)
    by the definition of \(p_{\alpha}\).
    Hence, the result follows.
\end{enumerate}
}

\nt{
    With respect to the ordered basis \(\mcal B = \{\alpha; T \alpha; \cdots; T^{k-1}\alpha\}\)
    for \(Z(\alpha; T)\). Then,
    \[
        [U]_{\mcal B} = \begin{bmatrix}
            0 & 0 & \cdots & 0 & -c_0 \\
            1 & 0 & \cdots & 0 & -c_1 \\
            0 & 1 & \cdots & 0 & -c_2 \\
            \vdots & \vdots & \ddots & \vdots & \vdots \\
            0 & 0 & \cdots & 1 & -c_{k-1} \\
        \end{bmatrix} 
    \]
    where \(p_{\alpha}(x) = \sum_{i=0}^{k-1} c_ix^i + x^k\).
}

\dfn{Companion Matrix}{
    The matrix \([U]_{\mcal B}\) above is called
    the \textit{companion matrix} of \(p_{\alpha}\).
}

\dfn{Complementary \(T\)-invariant Subspace}{
    Let \(V\) be a finite-dimensional vector space over \(F\) and let \(T \in L(V)\).
    Let \(W\) be a \(T\)-invariant subspace of \(V\).
    If \(W'\) is a \(T\)-invariant subspace of \(V\) such that
    \(V = W \oplus W'\), we call it a \textit{complementary \(T\)-invariant
    subspace} of \(W\).
}

\dfn{\(T\)-admissible Subspace}{
    Let \(V\) be a finite-dimensional vector space over \(F\) and let \(T \in L(V)\).
    We say a subspace \(W\) of \(V\) is \textit{\(T\)-admissible} if
    \begin{enumerate}[nolistsep, label=(\roman*)]
        \ii \(W\) is \(T\)-invariant and
        \ii \(\fall f \in F[x],\: \fall \beta \in V,\: \big( f(T) \beta \in W
            \implies \exs \gamma \in W,\: f(T)\beta = f(T) \gamma\big)\).
    \end{enumerate}
}

\mlemma[compTinvarThenAdmiss]{}{
    Let \(V\) be a finite-dimensional vector space over \(F\) and let \(T \in L(V)\).
    Suppose \(W\) and \(W'\) are \(T\)-invariant subspaces such that
    \(V = W \oplus W'\).
    Then, \(W\) and \(W'\) are \(T\)-admissible.
}
\pf{Proof}{
    The condition (i) is already true.
    Suppose \(f(T) \beta \in W\) where \(f \in F[x]\) and \(\beta \in V\).
    We can write \(\beta = \gamma + \gamma'\) where \(\gamma \in W\) and \(\gamma' \in W'\).
    Then, \(f(T) \beta = f(T) \gamma + f(T) \gamma'\).
    As \(W\) and \(W'\) are \(T\)-invariant, we have
    \(f(T)\beta - f(T) \gamma = f(T) \gamma' \in W \cap W'\).
    Hence, \(f(T) \beta = f(T) \gamma\).
}

\thm[cycDecomp]{Cyclic Decomposition Theorem}{
    Let \(V\) be a finite-dimensional vector space over \(F\) and let \(T \in L(V)\).
    Let \(W_0\) be a proper \(T\)-admissible subspace of \(V\).
    Then, there exist \(\alpha_1, \cdots, \alpha_r \in V \setminus \{0\}\) 
    such that
    \begin{enumerate}[nolistsep, label=(\roman*)]
        \ii \(V = W_0 \oplus \big(\oplus_{i=1}^r Z(\alpha_i; T)\big)\) and
        \ii \(p_{i+1} \mid p_i\) for each \(i \in [r - 1]\)
    \end{enumerate}
    where \(p_i\) is the \(T\)-annihilator of \(\alpha_i\).
    Furthermore, \(r\) and \(p_{1}, \cdots, p_{r}\) are uniquely decided.
}
\pf{Proof}{
    In this proof we denote the monic generator of \(S_T(\alpha; W)\) by \ul{\(s_T(\alpha; W)\)}
    and \(f(T)\beta\) by \ul{\(f \beta\)} for conciseness.

    \mclm{Claim 0}{
        For \(\alpha, \beta \in V\) and a subspace \(W\) of \(V\),
        if \(\alpha - \beta \in W\), then \(S_T(\alpha; W) = S_T(\beta; W)\).
        Moreover, if \(W\) is \(T\)-invariant,
        then \(W + Z(\alpha; T) = W + Z(\beta; T)\).
    }

    Let \(\gamma \triangleq \alpha - \beta \in W\).
    Then, \(g \in S_T(\alpha; W) \iff g \alpha \in W
    \iff g (\beta + \gamma) \in W \iff g \beta \in W \iff g \in S_T(\beta; W)\).

    Assuming \(W\) is \(T\)-invariant,
    we have, for each \(g \alpha \in Z(\alpha; T)\),
    \(g \alpha = g (\beta + \gamma) \in Z(\beta; T) + W\);
    hence \(Z(\alpha; T) + W \subseteq Z(\beta; T) + W\). \checkmark

    \mclm{Claim 1}{
        For a proper \(T\)-admissible subspace \(W\) of \(V\),
        there exists \(\alpha \in V \setminus W\)
        such that \(s_T(\alpha; W) \alpha = 0\).
    }

    Take any \(\beta \in V \setminus W\).
    Let \(f \triangleq s_T(\beta; W)\) so \(f \beta \in W\).
    By \(T\)-admissibility, \(\exs \gamma \in W,\: f \beta = f \gamma\).
    Let \(\alpha \triangleq \beta - \gamma\) so that \(f \alpha = 0\).
    Moreover, \(S_T(\alpha; W) = S_T(\beta; W) = (f)\) as \(W\) is \(T\)-invariant.
    Hence, \(f = s_T(\beta; W) = s_T(\alpha; W)\).
    and \(f \in M(\alpha; T)\),
    which implies \((f) = S_T(\alpha; W) \subseteq M(\alpha; T)\).
    Conversely, if \(g \in M(\alpha; T)\), then \(g \alpha = 0 \in W\)
    and thus \(M(\alpha; T) \subseteq S_T(\alpha; W)\);
    \(f\) is the \(T\)-annihilator of \(\alpha\) as well.

    \mclm{Claim 2}{
        Let \(W\) be a subspace of \(V\).
        If \(s_T(\alpha; W) \alpha = 0\), then
        \(S_T(\alpha; W) = M(\alpha; T)\) and \(W \cap Z(\alpha; T) = \{0\}\).
    }

    It is easily shown that \(S_T(\alpha; T) = M(\alpha; T)\).
    Suppose \(g \alpha \in W \cap Z(\alpha; T)\).
    Then, \(g \in S_T(\alpha; W) = M(\alpha; T)\),
    and thus \(g \alpha = 0\). \checkmark
    

    \mclm{Claim 3}{
        For a proper \(T\)-invariant subspace \(W\) of \(V\),
        \(\beta \in \argmax_{\alpha \in V} \deg s_T(\alpha; W)\) exists,
        moreover, \(W \cap \argmax_{\alpha \in V} \deg s_T(\alpha; W) = \OO\).
        As a corollary, \(W + Z(\beta; T)\) is a \(T\)-invariant subspace of \(V\)
        which has \(W\) as its proper subspace.
    }

    If \(p\) is the characteristic polynomial of \(T\),
    then \(p \alpha = 0 \in W\) for all \(\alpha \in V\) by \Cref{th:cayley},
    i.e., \(p \in S_T(\alpha; T)\).
    Therefore, \(\deg s_T(\alpha; W)\) is bounded above by \(\deg p = \dim V\).
    Hence, \(A = \argmax_{\alpha \in V} \deg s_T(\alpha; W) \neq \OO\), thus we may
    take \(\beta \in A\).

    If \(\beta \in W\), we will have \(s_T(\alpha; W) = 1\) for all \(\alpha \in V\)
    and thus \(\alpha = s_T(\beta; W) \alpha \in W\),
    contradicting \(W \subsetneq V\). \checkmark\par
    {
        \setlength{\interspacetitleruled}{0pt}%
        \setlength{\algotitleheightrule}{0pt}%
        \LinesNumberedHidden%
        \begin{algorithm}[H]
            \TitleOfAlgo{Construct \(\beta_1, \cdots, \beta_r\) and \(W_1, \cdots, W_r\)}
            \(i \gets 0\)\;
            \While{\(W_i \neq V\)}{
                Take any \(\beta_{i+1} \in \argmax_{\alpha \in V} \deg s_T(\alpha; W_i)\)
                \Comment*[r]{well-defined by \textbf{\textit{Claim 3}}}
                \(W_{i+1} \gets W_i + Z(\beta_{i+1}, W_i)\)\;
                \(i \gets i + 1\)\;
            }
        \end{algorithm}
    }

    This algorithm above eventually ends in at most \(\dim V\) loops
    until we have \(V = W_0 + \sum_{i=1}^{r} Z(\beta_i, W_{i-1})\) by \textbf{\textit{Claim 3}}.
    Also, by the construction, \(W_k = W_{k-1} + Z(\beta_k, W_{k-1})\)
    for each \(k \in [r]\),
    and each \(W_k\) is \(T\)-invariant.
    \[
        \textstyle W_k = W_0 + \sum_{i=1}^{k-1} Z(\beta_i; W_{i-1})
    \]

    \mclm{Claim 4}{
        For each \(k \in [r]\) and \(\beta \in V\),
        write \(f \beta = \beta_0 + \sum_{i=1}^{k-1} g_i \beta_i\)
        where \(f = s_T(\beta; W_{k-1})\), \(g_i \in F[x]\),
        and \(\beta_i \in W_{i}\) for each \(i \in [k-1]\).
        Then, \(f \mid g_i\) for each \(i \in [k-1]\),
        and \(\beta_0 = f \gamma_0\) for some \(\gamma_0 \in W_0\).
    }

    Fix \(k \in [r]\) for now.
    By \Cref{th:euclid}, \(g_i = fq_i + r_i\)
    for some \(q_i, r_i \in F[x]\) such that it is either \(r_i = 0\)
    or \(\deg r_i < \deg f\).
    Let \(\gamma \triangleq \beta - \sum_{i=1}^{k-1} h_i \beta_i\).
    Then, we have:
    \[\begin{aligned}[t]
        f\gamma &= f\beta - \textstyle\sum_{i=1}^{k-1} fh_i \beta_i \\
                  &= \textstyle\big(\beta_0 + \sum_{i=1}^{k-1} g_i \beta_i\big)
                      - \sum_{i=1}^{k-1} (g_i-r_i) \beta_i \\
                  &= \textstyle \beta_0 + \sum_{i=1}^{k-1} r_i \beta_i.
    \end{aligned}\]
    Note that, by \textbf{\textit{Claim 0}}, \(S_T(\gamma; W_{k-1}) = S_T(\beta; W_{k-1}) = (f)\).

    For the sake of contradiction, suppose \(r_i \neq 0\) for some \(i \in [k-1]\) and
    let \(j\) be the maximum among such \(i\) so
    \(f\gamma = \beta_0 + \sum_{i=1}^{j} r_i \beta_i\).
    Let \(p \triangleq s_T(\gamma; W_{j-1})\).
    As \(W_j \subseteq W_{k-1}\), we have \(p \in S_T(\gamma; W_{k-1}) = (f)\), i.e.,
    \(p = fg\) for some \(g \in F[x]\). Then,
    \[\textstyle
        p \gamma = gf \gamma = g \beta_0 + \sum_{i=1}^{j-1} gr_i \beta_i + g r_j \beta_j.
    \]
    Then, \(p \gamma \in W_{j-1}\) by the definition of \(p\)
    and \(g \big(\beta_0 + \sum_{i=1}^{j-1} r_i \beta_i\big) \in W_{j-1}\)
    as \(W_{j-1}\) is \(T\)-invariant. Hence, we have \(g r_j \beta_j \in W_{j-1}\),
    i.e., \(g r_j \in S_T(\beta_j; W_{j-1})\).
    Hence, by the construction of \(\beta_j\), \[
        \deg (g r_j) 
        \underbrace{\ge}_{\text{by definition}}
        \deg s_T(\beta_j; W_{j-1})
        \underbrace{\ge}_{\text{by construction of } \beta_j}
        \deg s_T(\gamma; W_{j-1}) = \deg p = \deg (fg).
    \]
    Therefore, \(\deg r_j \ge \deg f\), which is a contradiction.
    Hence, \(r_i = 0\) for all \(i \in [k-1]\); \(f \mid g_i\).

    Now, we are left with \(\beta_0 = f \gamma\).
    By \(T\)-admissibility of \(W_0\), there exists \(\gamma_0 \in W_0\)
    such that \(f \gamma_0 = f \gamma = \beta_0\). \checkmark
    \vspace*{.7em}

    Fix any \(k \in [r]\).
    Let \(p_k \triangleq s_T(\beta_k; W_{k-1})\).
    Then, by \textbf{\textit{Claim 4}},
    \(p_k \beta_k = p_k \gamma_0 + \sum_{i=1}^{k-1} p_k h_i \beta_i\)
    for some \(\gamma_0 \in W_0\) and \(h_i \in F[x]\).
    Let \(\alpha_k \triangleq \beta_k - \gamma_0 - \sum_{i=1}^{k-1} h_i \beta_i\)
    so that \(p_k \alpha_k = 0\) and \(\alpha_k - \beta_k \in W_{k-1}\).
    Then, by \textbf{\textit{Claim 0}} and  \textbf{\textit{Claim 2}},
    we have:
    \begin{itemize}[nolistsep]
        \ii \((p_k) = S_T(\beta; W_{k-1}) =  S_T(\alpha_k; W_{k-1}) = M(\alpha_k; T)\)
        \ii \(W_{k-1} \cap Z(\alpha_k; T) = \{0\}\)
        \ii \(W_{k-1} + Z(\alpha_k; T) = W_{k-1} + Z(\beta_k; T)\)
    \end{itemize}
    As \(k\) is arbitrary, we have
    \[
        W_k = W_0 \oplus \big(\oplus_{i=1}^k Z(\alpha_k; T)\big).
    \]

    Moreover, note that \(\alpha_1, \cdots, \alpha_r\) retains the defining property
    of \(\beta_1, \cdots, \beta_r\),
    i.e., \(\alpha_k \in \argmax_{\alpha \in V} \deg s_T(\alpha; W_{k-1})\).
    \textbf{\textit{Claim 4}} holds when \(\beta_1, \cdots, \beta_r\)
    are replaced with \(\alpha_1, \cdots, \alpha_r\).
    Hence, applying the alternative version of \textbf{\textit{Claim 4}}
    to the trivial equation
    \[
        \textstyle p_k \alpha_k = 0 \cdot 0 + \sum_{i=1}^{k-1} p_i \alpha_i,
    \]
    we have \(p_i \mid p_k\) for each \(i \in [k - 1]\).
    The existence part of the theorem is now proven.

    Now, we shall show the uniqueness of such decomposition.
}

\cor{}{
    Let \(V\) be a finite-dimensional vector space over \(F\) and let \(T \in L(V)\).
    Let \(W\) be a \(T\)-invariant subspace of \(V\).
    Then, \(W\) is \(T\)-admissible
    if and only if there exists another \(T\)-invariant subspace \(W'\) of \(V\)
    such that \(V = W \oplus W'\).
}
\pf{Proof}{
    (\(\Rightarrow\)) \Cref{th:cycDecomp}
    (\(\Leftarrow\)) \Cref{lem:compTinvarThenAdmiss}
}

\end{document}
